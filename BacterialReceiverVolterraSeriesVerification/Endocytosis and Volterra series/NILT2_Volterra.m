function ft=NILT2_Volterra(F,tm);
global N M qd t NT omega
M=128;
P=3;
Er=1e-8;
alfa1=0;
alfa2=0;
N=2*M;
qd=2*P+1;
NT=2*tm*N/(N-2);
Ken=log(1-1/sqrt(1+Er))/NT;
omega=2*pi/NT;
c1=alfa1-Ken;
c2=alfa2-Ken;
Nw=N+qd-1;
Ac1=c1-1i*omega*(0:Nw);
Ac2=c2-1i*omega*(0:Nw);
Ac1c=cat(2,Ac1,conj(Ac1));
t=linspace(0,tm,M);
[s1,s2]=ndgrid(Ac1c,Ac2);
Fs1s2(:,:,1)=feval(F,s1,s2);
[s1,s2]=ndgrid(Ac1c,conj(Ac2));
Fs1s2(:,:,2)=feval(F,s1,s2);
Fst=Pnilt2(Fs1s2,c2);
Fs1t2(:,:,1)=Fst(1:Nw+1,:).';
Fs1t2(:,:,2)=Fst(Nw+2:2*Nw+2,:).';
ft1t2=Pnilt2(Fs1t2,c1);
ft=real(diag(ft1t2)).';